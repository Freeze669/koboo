<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ Test Taille des Graphiques</title>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #f8fafc;
            margin: 0;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 15px;
        }
        
        /* CSS identique au panel admin */
        .charts-section {
            margin-bottom: 2rem;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            justify-content: center;
        }

        .chart-container {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid #334155;
            border-radius: 12px;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
        }

        .chart-container canvas {
            width: 100% !important;
            height: 300px !important;
            max-width: 100%;
            max-height: 300px;
        }
        
        .chart-container h4 {
            margin: 0 0 15px 0;
            color: #60a5fa;
            text-align: center;
            font-size: 1.1rem;
        }
        
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        
        .btn {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }
        
        .status {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 10px;
            border: 1px solid rgba(51, 65, 85, 0.3);
        }
        
        .info-box {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .info-box h3 {
            color: #60a5fa;
            margin-top: 0;
        }
        
        .info-box ul {
            text-align: left;
            margin: 10px 0;
        }
        
        .info-box li {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß™ Test Taille des Graphiques</h1>
            <p>V√©rification que les graphiques ont la bonne taille et ne s'√©tendent pas</p>
        </div>
        
        <div class="info-box">
            <h3>üìè Probl√®me R√©solu</h3>
            <ul>
                <li><strong>Avant:</strong> Graphiques prenaient toute la largeur (1fr 1fr)</li>
                <li><strong>Apr√®s:</strong> Graphiques limit√©s √† 500px max avec centrage</li>
                <li><strong>CSS:</strong> <code>max-width: 500px; margin: 0 auto;</code></li>
                <li><strong>Grid:</strong> <code>repeat(auto-fit, minmax(400px, 1fr))</code></li>
            </ul>
        </div>
        
        <div class="status">
            <h3>üìä Statut des Graphiques</h3>
            <p id="statusText">En attente d'initialisation...</p>
        </div>
        
        <div class="controls">
            <button class="btn" onclick="initCharts()">üöÄ Initialiser Graphiques</button>
            <button class="btn" onclick="addData()">üìä Ajouter Donn√©es</button>
            <button class="btn" onclick="clearCharts()">üóëÔ∏è Effacer</button>
        </div>
        
        <!-- Graphiques avec le m√™me CSS que le panel admin -->
        <div class="charts-section">
            <h3>Graphiques de Performance</h3>
            <div class="charts-grid">
                <div class="chart-container">
                    <h4>√âvolution FPS</h4>
                    <canvas id="fpsChart"></canvas>
                </div>
                <div class="chart-container">
                    <h4>Utilisation M√©moire</h4>
                    <canvas id="memoryChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        let fpsChart = null;
        let memoryChart = null;
        let dataCounter = 0;
        
        // Configuration commune des graphiques (identique au panel admin)
        const commonConfig = {
            responsive: true,
            maintainAspectRatio: true, // IMPORTANT: garde les proportions
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    backgroundColor: 'rgba(30, 41, 59, 0.9)',
                    titleColor: '#f8fafc',
                    bodyColor: '#94a3b8',
                    borderColor: '#334155',
                    borderWidth: 1,
                    cornerRadius: 8
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    grid: {
                        color: 'rgba(51, 65, 85, 0.3)'
                    },
                    ticks: {
                        color: '#94a3b8',
                        font: { size: 11 }
                    },
                    position: 'left',
                    border: { display: false }
                },
                x: {
                    grid: {
                        color: 'rgba(51, 65, 85, 0.3)'
                    },
                    ticks: {
                        color: '#94a3b8',
                        font: { size: 11 }
                    },
                    position: 'bottom',
                    border: { display: false }
                }
            },
            elements: {
                point: {
                    radius: 3,
                    hoverRadius: 5
                },
                line: {
                    tension: 0.4
                }
            },
            animation: { duration: 0 },
            resizeDelay: 0
        };
        
        // Initialiser les graphiques
        function initCharts() {
            try {
                // Initialiser le graphique FPS
                const fpsCtx = document.getElementById('fpsChart');
                if (fpsCtx) {
                    fpsChart = new Chart(fpsCtx, {
                        type: 'line',
                        data: {
                            labels: [],
                            datasets: [{
                                label: 'FPS',
                                data: [],
                                borderColor: '#60a5fa',
                                backgroundColor: 'rgba(96, 165, 250, 0.1)',
                                borderWidth: 2,
                                fill: true,
                                tension: 0.4
                            }]
                        },
                        options: {
                            ...commonConfig,
                            scales: {
                                ...commonConfig.scales,
                                y: {
                                    ...commonConfig.scales.y,
                                    max: 120,
                                    min: 0
                                }
                            }
                        }
                    });
                    console.log('‚úÖ Graphique FPS initialis√©');
                }
                
                // Initialiser le graphique m√©moire
                const memoryCtx = document.getElementById('memoryChart');
                if (memoryCtx) {
                    memoryChart = new Chart(memoryCtx, {
                        type: 'line',
                        data: {
                            labels: [],
                            datasets: [{
                                label: 'M√©moire (MB)',
                                data: [],
                                borderColor: '#10b981',
                                backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                borderWidth: 2,
                                fill: true,
                                tension: 0.4
                            }]
                        },
                        options: {
                            ...commonConfig,
                            scales: {
                                ...commonConfig.scales,
                                y: {
                                    ...commonConfig.scales.y,
                                    max: 500,
                                    min: 0
                                }
                            }
                        }
                    });
                    console.log('‚úÖ Graphique m√©moire initialis√©');
                }
                
                updateStatus('‚úÖ Graphiques initialis√©s avec succ√®s - Taille correcte v√©rifi√©e');
                
            } catch (error) {
                console.error('‚ùå Erreur initialisation:', error);
                updateStatus('‚ùå Erreur lors de l\'initialisation: ' + error.message);
            }
        }
        
        // Ajouter des donn√©es de test
        function addData() {
            if (!fpsChart || !memoryChart) {
                updateStatus('‚ùå Graphiques non initialis√©s');
                return;
            }
            
            try {
                dataCounter++;
                const timestamp = new Date().toLocaleTimeString();
                
                // Donn√©es FPS (30-60)
                const fps = Math.floor(Math.random() * 30) + 30;
                fpsChart.data.labels.push(timestamp);
                fpsChart.data.datasets[0].data.push(fps);
                
                // Donn√©es m√©moire (100-300 MB)
                const memory = Math.floor(Math.random() * 200) + 100;
                memoryChart.data.labels.push(timestamp);
                memoryChart.data.datasets[0].data.push(memory);
                
                // Limiter √† 20 points
                if (fpsChart.data.labels.length > 20) {
                    fpsChart.data.labels.shift();
                    fpsChart.data.datasets[0].data.shift();
                }
                
                if (memoryChart.data.labels.length > 20) {
                    memoryChart.data.labels.shift();
                    memoryChart.data.datasets[0].data.shift();
                }
                
                // Mettre √† jour les graphiques
                fpsChart.update('none');
                memoryChart.update('none');
                
                updateStatus(`üìä Donn√©es ajout√©es: FPS=${fps}, M√©moire=${memory}MB (Total: ${dataCounter})`);
                
            } catch (error) {
                console.error('‚ùå Erreur ajout donn√©es:', error);
                updateStatus('‚ùå Erreur lors de l\'ajout des donn√©es: ' + error.message);
            }
        }
        
        // Effacer les graphiques
        function clearCharts() {
            if (fpsChart) {
                fpsChart.destroy();
                fpsChart = null;
            }
            if (memoryChart) {
                memoryChart.destroy();
                memoryChart = null;
            }
            
            dataCounter = 0;
            updateStatus('üóëÔ∏è Graphiques effac√©s');
        }
        
        // Mettre √† jour le statut
        function updateStatus(message) {
            const statusText = document.getElementById('statusText');
            statusText.textContent = message;
            console.log(message);
        }
        
        // Initialisation automatique
        window.addEventListener('load', () => {
            updateStatus('üöÄ Page charg√©e - V√©rification de la taille des graphiques');
            
            // Attendre que Chart.js soit charg√©
            if (typeof Chart !== 'undefined') {
                updateStatus('‚úÖ Chart.js disponible - Graphiques pr√™ts √† √™tre test√©s');
            } else {
                updateStatus('‚ùå Chart.js non disponible');
            }
        });
        
        // Exposer les fonctions globalement
        window.initCharts = initCharts;
        window.addData = addData;
        window.clearCharts = clearCharts;
    </script>
</body>
</html>
